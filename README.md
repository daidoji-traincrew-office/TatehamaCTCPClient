# TatehamaCTCPClient
 
## 注意
ProdサーバとDevサーバで使用できるファイルが異なります。Devサーバの場合はdevをファイル名に含むzipファイルをReleaseからダウンロードして使用してください。  
起動するにはTatehamaCTCPClient.exeを実行してください。  
なお、同梱ファイルが全て揃っていなければ正常に動作しません。

## 基本の使い方
画面上の進路ボタンを押すことで進路を開通させることができます。  
一部駅は進路選別式になっており、着点ボタンを押す必要があります。  
列車が進入した進路のボタンは自動で定位に戻ります。  
進行定位としたい場合は、進行定位ボタンを使用してください。進行定位ボタンを押した直後に進路ボタンを押すとその進路は自動で定位に戻らなくなります。  
一度開通させた進路を手動で取り消したい場合は取消ボタンを押してから点灯または点滅中のボタンを押してください。  
誘導切替ボタンを押すと、対応する進路ボタンが誘導進路用のボタンに切り替わります。  
  
進路を本ソフトから扱うには、駅ごとに以下の条件を満たしている必要があります。  
1. 扱う駅の駅扱切替てこを信号卓側で集中扱いする  
2. 本ソフトのナビゲーションウィンドウから扱う駅を管轄駅に指定する  

これらを満たさない駅は新たに進路を開通させることができません。（取消のみ可能）

それ以外の機能、操作は概ねTIDソフトに準じますが、下記など一部が異なります。

### TIDソフトとの違い
- TRAIN CREW本体とは接続できません
- 拡大鏡のモード変更ができず、TIDソフトのトグルモードのみ使用できます
- 列車番号強調を任意の列車に設定することはできません



## 機能紹介

- [CTCP画面を拡大または縮小したい（拡大縮小機能）](#ctcp画面を拡大または縮小したい拡大縮小機能)
  - [フィット表示](フィット表示)
  - [倍率固定表示](倍率固定表示)
- [縮小表示時に一部だけ拡大して表示したい（拡大鏡機能）](#縮小表示時に一部だけ拡大して表示したい拡大鏡機能)
- [CTCP画面のスクリーンショットをとりたい（スクリーンショット機能）](#ctcp画面のスクリーンショットをとりたいスクリーンショット機能)
- [CTCPを常に他のウィンドウの手前に重ねて表示したい（最前面表示機能）](#ctcpを常に他のウィンドウの手前に重ねて表示したい最前面表示機能)
- [エラー時にダイアログボックスが表示されないようにしたい（サイレント（ではない）モード（以下、サイレントモード）について）](#エラー時にダイアログボックスが表示されないようにしたいサイレントではないモード以下サイレントモードについて)
- [表示される時刻を変更したい（時刻調節機能）](#表示される時刻を変更したい時刻調節機能)
  - [クイック時刻設定](#クイック時刻設定)
- [CTCPを複数ウィンドウに分けて表示したい（マルチウィンドウ機能）](#ctcpを複数ウィンドウに分けて表示したいマルチウィンドウ機能)
- [設定ファイルについて](#設定ファイルについて)
- [ショートカットキー](#ショートカットキー)

### CTCP画面を拡大または縮小したい（拡大縮小機能）
デフォルト状態では**50～200%の間で9段階**（25の倍数または90、110）の拡大縮小とウィンドウサイズに合わせて無段階で拡大縮小する**フィット表示**ができます。
拡大率表示部分を**左クリック**で1段階**縮小**し、**右クリック**で1段階**拡大**することができます。  
また、CTCP本画面を右クリックして表示されるメニューから拡大率を選択したり、フィット表示[（後述）](#フィット表示)に変更することができます。  
Ctrlキーを押しながらマウスホイールを操作することでも拡大率の変更ができます。  
100%以外の拡大率では画質が悪化する可能性があります。  
[選択できる拡大率](#scalelist)や、[起動時の拡大率](#initialscale旧-scale)は[設定ファイル](#設定ファイルについて)から変更できます。

#### フィット表示
フィット表示の場合は拡大率表示が緑色になり、CTCP画面が常にウィンドウサイズにちょうど収まる形に拡大縮小されて表示されます。  
右クリックメニューから「フィット表示」を選択するとフィット表示にできるほか、拡大率表示部分をShiftキーを押した状態でクリックすることによりフィット表示のON/OFFを切り替えられます。  
フィット表示中はCtrlキーを押しながらマウスホイールを操作するとウィンドウサイズごと拡大率が変更されます。  
任意の拡大率に調整した後、後述の倍率固定表示に切り替えることで、その拡大率を維持したままウィンドウサイズが変更できるようになります。  

#### 倍率固定表示
倍率固定表示の場合は拡大率表示が赤色になり、一定の拡大率を維持したままウィンドウサイズを変更できます。
右クリックメニューから「倍率固定」を選択すると倍率固定表示にできるほか、拡大率表示部分をCtrlキーを押した状態でクリックすることにより倍率固定表示のON/OFFを切り替えられます。  
倍率固定表示中にCtrlキーを押しながらマウスホイールを操作するとフィット表示に切り替わります。  


### 縮小表示時に一部だけ拡大して表示したい（拡大鏡機能）
縮小表示時にマウスホイールを1回押すことで拡大鏡を表示できます。  
拡大鏡を表示している間も拡大鏡越しにボタンを押すことができます。  
拡大鏡のサイズは設定ファイルから[変更できます](#zoomsize)。  

### CTCP画面のスクリーンショットをとりたい（スクリーンショット機能）
**Ctrl+Cキー**か、CTCP本画面を右クリックして表示されるメニューからCTCP画面のスクリーンショットをクリップボードにコピーできます。  
コピーしたスクリーンショットはDiscordや各種画像編集ソフトなどにそのまま貼り付けることができます。  
なお、スクリーンショットに拡大縮小は反映されず、ウィンドウ内で一部が隠れている場合も隠れた部分を含めた全体がコピーされます。  

さらに、**Ctrlキーを押した状態でCTCP画面上をドラッグ**して範囲選択し、そのままCキーを押すことで、選択した範囲のみのスクリーンショットををクリップボードにコピーできます。  

ソフト本体では時刻はUI領域に表示されており、CTCP画面領域には含まれていませんが、この機能で生成したスクリーンショットは右上に時刻表示が追加されたものになっています。

### CTCPを常に他のウィンドウの手前に重ねて表示したい（最前面表示機能）
最前面表示の状態表示をクリックするか**Tabキー**で最前面表示のON/OFFを切り替えることができます。  
[設定ファイル](#設定ファイルについて)から起動時の最前面表示状態が指定できます[（後述）](#topmost)。

### エラー時にダイアログボックスが表示されないようにしたい（サイレント（ではない）モード（以下、サイレントモード）について）
サイレントモードの状態表示をクリックするか、右クリックメニューの「**サイレントモード**」をクリックすることで、サイレントモードのON/OFFを切り替えることができます。  
サイレントモードがONの場合、認証関連を除いたエラーが発生した際にダイアログボックスが表示されなくなり、代わりに警告音が鳴ります。  
警告音はsoundフォルダ内の`warning.wav`を差し替えることでカスタマイズできるほか、`warning.wav`を削除するとWindowsに設定されたエラー音が鳴るように設定できます。  
（デフォルトの警告音はCTCP製作者の自作音源を使用しております）  
**TRAIN CREWなど、他アプリケーションを使用中に起動したままにしておく場合、このモードをONにしておくことをお勧めします。**

### 表示される時刻を変更したい（時刻調節機能）
サーバへの接続の場合、サーバに設定された時差を受信して同じ時差をPCの時刻に適用して表示します。異なる時刻を表示させたい場合は右クリックメニューの「**クイック時刻設定**」から「**サーバ時刻**」のチェックを外すか、以下の方法で時刻を変更して下さい。サーバの時刻と同期しない設定になっている場合、時刻表示の文字が黄色くなります。  
表示時刻は秒単位で調節できるようになっていますが、サーバと時刻が同期されなくなります。  
時刻表示部分を**左クリック**で1時間**戻し**、**右クリック**で1時間**進める**ことができます。  
同様の操作で、**Ctrlキー（Shiftキーを押さない）同時押し**で1分を、**Ctrl+Shiftキー同時押し**で1秒を戻したり進めたりすることができます。  
キー操作にも対応しています（後述）。  
サーバに設定された時差を適用する設定に戻すには、右クリックメニューの「**クイック時刻設定**」から「**サーバ時刻**」にチェックを入れるか、時刻表示部分でマウスホイールを押し込んでください。  
[設定ファイル](#設定ファイルについて)から起動時のPC設定時刻との時差が時単位で指定できますが、ほぼ死に機能です[（後述）](#timeoffset)。

#### クイック時刻設定
右クリックメニューの「**クイック時刻設定**」から、「○時台」を選択することで、時刻表示の時が○時になります。  
これにより、ワンボタンで目的の時を指定できるようになり、1時間ずつ調節する必要が無くなります。


### CTCPを複数ウィンドウに分けて表示したい（マルチウィンドウ機能）
**Ctrlキーを押した状態でCTCP画面上をドラッグ**して範囲選択し、**Ctrlキーを押したまま選択枠が緑色の時にマウスボタンから指を離す**と、選択した範囲の画面が別のウィンドウ（以下、サブウィンドウ）で表示されます。  
サブウィンドウではメインウィンドウと同時に表示が更新され、ボタンを押すこともできます。  
また、ドラッグでサブウィンドウを移動でき、ウィンドウサイズを変更することで拡大縮小できます。ウィンドウサイズをリセットするには倍率表示をクリックしてください。  
右クリックメニューから、ウィンドウ名の変更が行えます。  
メインウィンドウと同様の操作で、サブウィンドウに表示されている範囲内のみのスクリーンショットをクリップボードにコピーできます。

### 設定ファイルについて
本ソフトの起動時の設定は、設定ファイルから指定することができます。  


設定ファイル`setting.txt`はexeファイルと同じ階層、  または`（ドキュメントフォルダ）\TRAIN CREW Tool\TatehamaCTCPClient`に配置してください。  
両方のフォルダに配置されていた場合は前者の設定が優先して適用されます。  
どちらのフォルダにも設定ファイルが無い場合は起動時にexeファイルと同じフォルダ内に`setting.txt`が生成されます。  
`setting.txt`内は、1行ごとに`（設定項目名）=（値）`の形式で入力してください。値はスペースや大文字交じりでも動作します。  


設定ファイルの変更をソフトに適用するには、本ソフトの再起動が必要です。  


設定項目は全て記載する必要はありません。2つの設定ファイルのうち片方にのみ記載されている設定項目は記載されている側の設定値が、どちらの設定ファイルにも記載されていない設定項目はデフォルト値が適用されます。  
設定項目ごとの解説は以下をご覧ください。

#### topMost
起動時に、[最前面表示](#ctcpを常に他のウィンドウの手前に重ねて表示したい最前面表示機能)するか否かを選択する項目です。  
最前面表示は起動後でも切り替え可能です。  

**（値）**
- `true`  
起動時に最前面表示になります。
- `false`  
起動時に最前面表示にはなりません。

#### scaleList
[拡大縮小機能](#ctcp画面を拡大または縮小したい拡大縮小機能)で選択できる拡大率を設定する項目です。  
拡大率は1%から500%までの間で設定できます。  
**この項目は設定ファイルからのみ変更できます。**  

**（値）**  
CTCPソフト内で選択できるようにしたい拡大率を1以上500以下の自然数を昇順に半角カンマ（,）区切りで入力してください。  
昇順でない場合、拡大率変更時に拡大と縮小が逆になる場合があります。  

**（入力例）**  
`scaleList=50,75,90,100,110,125,150,175,200`

#### initialScale（旧 scale）
起動時の、CTCP画面の[拡大率](#ctcp画面を拡大または縮小したい拡大縮小機能)を設定する項目です。  
CTCP画面の拡大率は起動後でも切り替え可能です。  

**（値）**
- （拡大率として設定可能な自然数）  
上記に該当する数値を入力した場合、その拡大率が適用された状態で起動します。
- `fit`  
起動時にフィット表示となります。

#### timeOffset
起動時の、[時刻表示のPC設定時刻との時差](#表示される時刻を変更したい時刻調節機能)を設定する項目です。時単位での設定となります。  
時刻表示は起動後でも切り替え可能です。  
なお、サーバとの接続時にはサーバに設定された時差に置き換わり、TRAIN CREW本体との接続時にはゲーム内時刻を表示するのでほぼ死に機能となりました。  

**（値）**
- （任意の整数）  
入力した数値分だけ時が加算された状態で起動します。


#### zoomSize
[拡大鏡](#縮小表示時に一部だけ拡大して表示したい拡大鏡機能)の直径を設定する項目です。  
**拡大鏡の直径は設定ファイルからのみ変更できます。**  

**（値）**
- （20以上の任意の自然数）  
入力した数値が拡大鏡の直径となります。デフォルトの値は**240**です。




#### silent
起動時に、[サイレントモード](#エラー時にダイアログボックスが表示されないようにしたいサイレントではないモード以下サイレントモードについて)をONにするか否かを選択する項目です。  
サイレントモードのON/OFFは起動後でも切り替え可能です。  

**（値）**
- `true`  
起動時に、サイレントモードが**ON**になります。
- `false`  
起動時に、サイレントモードが**OFF**になります。

#### blinkInterval
ボタンの点滅間隔を指定する項目です。  
**点滅間隔は設定ファイルからのみ変更できます。**  

**（値）**
- （0より大きい任意の実数）  
入力した数値がボタンの点滅間隔となります。デフォルトの値は**0.5**です。
- `0`  
ボタンが点滅しなくなります。おすすめしません。


### ショートカットキー
下記はJIS配列キーボード（一般的な日本語入力用キーボード）の場合のものです。  
デバッグモードでは一部異なる場合があります。  

| キー  | 機能 |
| ------------- | ------------- |
| Ctrl+**C**  | [スクリーンショットのコピー](#ctcp画面のスクリーンショットをとりたいスクリーンショット機能)  |
| **Tab**  | [最前面表示の切り替え](#ctcpを常に他のウィンドウの手前に重ねて表示したい最前面表示機能)  |
| **↑（上キー）** または **W**  | 上にスクロール  |
| **↓（下キー）** または **S**  | 下にスクロール  |
| **←（左キー）** または **A**  | 左にスクロール  |
| **→（右キー）** または **D**  | 右にスクロール  |
| Shift+**↑（上キー）** または **W**  | 上に低速スクロール  |
| Shift+**↓（下キー）** または **S**  | 下に低速スクロール  |
| Shift+**←（左キー）** または **A**  | 左に低速スクロール  |
| Shift+**→（右キー）** または **D**  | 右に低速スクロール  |
| **数字キー（テンキーでない）**  | 横位置移動  |
| **数字キー（テンキー）**  | 移動  |
| **PageUp**または **:（コロンキー）**  | [1時間進める](#表示される時刻を変更したい時刻調節機能)  |
| Ctrl+**PageUp**または **:（コロンキー）**  | [1分進める](#表示される時刻を変更したい時刻調節機能)  |
| Ctrl+Shift+**PageUp**または **:（コロンキー）**  | [1秒進める](#表示される時刻を変更したい時刻調節機能)  |
| **PageDown**または **;（セミコロンキー）**  | [1時間戻す](#表示される時刻を変更したい時刻調節機能)  |
| Ctrl+**PageDown**または **;（セミコロンキー）**  | [1分戻す](#表示される時刻を変更したい時刻調節機能)  |
| Ctrl+Shift+**PageDown**または **;（セミコロンキー）**  | [1秒戻す](#表示される時刻を変更したい時刻調節機能)  |
| Ctrl+**マウスホイール**  | [拡大縮小](#ctcp画面を拡大または縮小したい拡大縮小機能)  |
| Shift+**マウスホイール**  | 横スクロール  |
